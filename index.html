<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Farm Planner Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .slide {
            transform: translateX(100%);
            transition: transform 0.6s cubic-bezier(0.4, 0.0, 0.2, 1);
        }
        .slide.active {
            transform: translateX(0);
        }
        .slide.prev {
            transform: translateX(-100%);
        }
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .soil-card {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .crop-card {
            background: linear-gradient(145deg, #f0f9ff, #e0f2fe);
            border-left: 4px solid #0ea5e9;
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse-grow {
            animation: pulseGrow 2s infinite;
        }
        @keyframes pulseGrow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        #map {
            height: 300px;
            border-radius: 12px;
        }
        .dark .soil-card {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .dark .crop-card {
            background: linear-gradient(145deg, #1e293b, #334155);
            border-left: 4px solid #06b6d4;
        }
        .dropdown-suggestions {
            max-height: 200px;
            overflow-y: auto;
            border: 1px solid #d1d5db;
            border-top: none;
            background: white;
            position: absolute;
            width: 100%;
            z-index: 1000;
            border-radius: 0 0 8px 8px;
        }
        .dark .dropdown-suggestions {
            background: #374151;
            border-color: #4b5563;
        }
        .suggestion-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #e5e7eb;
        }
        .dark .suggestion-item {
            border-color: #4b5563;
        }
        .suggestion-item:hover {
            background: #f3f4f6;
        }
        .dark .suggestion-item:hover {
            background: #4b5563;
        }
        .crop-score {
            position: absolute;
            top: 12px;
            right: 12px;
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
        }
        .best-crop {
            border: 3px solid #10b981;
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.3);
        }
        .address-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
        }
        @media (max-width: 640px) {
            .address-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 transition-colors duration-300">
    <button id="darkModeToggle" class="fixed top-4 right-4 z-50 p-3 bg-white dark:bg-gray-800 rounded-full shadow-lg hover:shadow-xl transition-all duration-300">
        <i class="fas fa-moon dark:hidden text-gray-600"></i>
        <i class="fas fa-sun hidden dark:block text-yellow-400"></i>
    </button>

    <div class="relative w-full h-screen overflow-auto">
        <div id="slide1" class="slide active absolute inset-0 flex items-center justify-center gradient-bg">
            <div class="text-center text-white px-6 animate-fade-in">
                <div class="mb-8">
                    <i class="fas fa-seedling text-6xl mb-4 pulse-grow"></i>
                    <h1 class="text-5xl md:text-7xl font-bold mb-4">Smart Farm Planner Pro</h1>
                    <p class="text-xl md:text-2xl mb-4 opacity-90">AI-Powered Soil Analysis & Crop Selection</p>
                    <p class="text-lg mb-8 opacity-80">Choose from 999+ crops with intelligent recommendations</p>
                </div>
                <button onclick="nextSlide()" class="bg-white text-purple-600 px-8 py-4 rounded-full text-lg font-semibold hover:bg-gray-100 transform hover:scale-105 transition-all duration-300 shadow-2xl">
                    <i class="fas fa-rocket mr-2"></i>Start Planning
                </button>
            </div>
        </div>

        <div id="slide2" class="slide absolute inset-0 overflow-y-auto min-h-screen p-4 bg-gradient-to-br from-green-50 via-blue-50 to-purple-50 dark:from-gray-800 dark:via-gray-900 dark:to-gray-800">
            <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-2xl p-8 w-full max-w-2xl mx-auto animate-fade-in my-8">
                <h2 class="text-3xl font-bold text-gray-800 dark:text-white mb-6 text-center">
                    <i class="fas fa-map-marker-alt text-green-500 mr-2"></i>Farm Details
                </h2>
                
                <div class="bg-blue-50 dark:bg-gray-700 p-6 rounded-lg mb-6 border border-blue-200 dark:border-gray-600">
                    <h3 class="font-bold text-lg text-blue-800 dark:text-blue-300 mb-2">üìç Enter your farm's complete address details below</h3>
                    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300 space-y-2">
                        <li>Start by providing accurate information such as: Street name or plot reference, Town or Village name, District & State, and Pincode.</li>
                        <li>üó∫Ô∏è You can auto-detect your location using the GPS button if you're currently on-site.</li>
                        <li>üìê Then, specify the land area and select the unit (Acres, Hectares, Bigha, Katha).</li>
                        <li>üåæ Use the searchable crop field to input your currently grown crop. You can start typing (e.g., ‚Äúrice‚Äù, ‚Äúcotton‚Äù, ‚Äúbanana‚Äù) to choose from our large dataset.</li>
                        <li>üíß Don‚Äôt forget to choose your water source and preferred budget range for better planning!</li>
                    </ul>
                    <p class="mt-4 text-sm text-gray-600 dark:text-gray-400">Once you're done, click ‚ÄúAnalyze & Get Recommendations‚Äù to receive a soil suitability report, crop rotation recommendations, and seasonal strategies.</p>
                </div>

                <form id="landForm" class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3">
                            <i class="fas fa-home mr-2"></i>Complete Address
                        </label>
                        <div class="address-grid">
                            <input type="text" id="street" class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Street Address">
                            <input type="text" id="town" class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Town/Village">
                            <input type="text" id="district" class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="District">
                            <input type="text" id="state" class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="State">
                        </div>
                        <div class="flex mt-4 space-x-2">
                            <input type="text" id="pincode" class="flex-1 p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Pincode">
                            <button type="button" onclick="getLocation()" class="px-4 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                                <i class="fas fa-crosshairs"></i>
                            </button>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-expand-arrows-alt mr-2"></i>Land Area
                            </label>
                            <div class="flex space-x-2">
                                <input type="number" id="landArea" class="flex-1 p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Enter area">
                                <select id="areaUnit" class="p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                                    <option value="acres">Acres</option>
                                    <option value="hectares">Hectares</option>
                                    <option value="bigha">Bigha</option>
                                    <option value="katha">Katha</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-wheat-awn mr-2"></i>Current Crop
                            </label>
                            <div class="relative">
                                <input type="text" id="currentCrop" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Search current crop..." autocomplete="off">
                                <div id="cropSuggestions" class="dropdown-suggestions hidden"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-cloud-rain mr-2"></i>Water Source
                            </label>
                            <select id="waterSource" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                                <option value="rain">Rainwater</option>
                                <option value="bore">Borewell</option>
                                <option value="canal">Canal</option>
                                <option value="river">River</option>
                                <option value="tank">Tank</option>
                            </select>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                                <i class="fas fa-coins mr-2"></i>Budget Range
                            </label>
                            <select id="budget" class="w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white">
                                <option value="low">Low (‚Çπ10,000 - ‚Çπ50,000)</option>
                                <option value="medium">Medium (‚Çπ50,000 - ‚Çπ2,00,000)</option>
                                <option value="high">High (‚Çπ2,00,000+)</option>
                            </select>
                        </div>
                    </div>
                    
                    <button type="submit" class="w-full bg-gradient-to-r from-green-500 to-blue-500 text-white py-3 rounded-lg font-semibold hover:from-green-600 hover:to-blue-600 transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-microscope mr-2"></i>Analyze & Get Smart Recommendations
                    </button>
                </form>
            </div>
        </div>

        <div id="slide3" class="slide absolute inset-0 p-6 bg-gradient-to-br from-amber-50 via-orange-50 to-red-50 dark:from-gray-800 dark:via-gray-900 dark:to-gray-800 overflow-y-auto">
            <div class="max-w-6xl mx-auto">
                <h2 class="text-4xl font-bold text-gray-800 dark:text-white mb-8 text-center animate-fade-in">
                    <i class="fas fa-flask text-amber-500 mr-3"></i>Advanced Soil Analysis
                </h2>
                
                <div class="grid md:grid-cols-2 gap-8">
                    <div class="space-y-6">
                        <div id="soilCards" class="space-y-4">
                            </div>
                        
                        <button onclick="nextSlide()" class="w-full bg-gradient-to-r from-purple-500 to-pink-500 text-white py-4 rounded-xl font-semibold hover:from-purple-600 hover:to-pink-600 transform hover:scale-105 transition-all duration-300">
                            <i class="fas fa-brain mr-2"></i>Get AI Crop Recommendations
                        </button>
                    </div>
                    
                    <div class="space-y-4">
                        <h3 class="text-xl font-semibold text-gray-800 dark:text-white mb-4">
                            <i class="fas fa-map-marked-alt mr-2"></i>Precise Location Map
                        </h3>
                        <div id="map" class="shadow-xl"></div>
                        <div id="locationInfo" class="bg-white dark:bg-gray-800 p-4 rounded-xl shadow-lg">
                            <p class="text-gray-600 dark:text-gray-300">Location details will appear here</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="slide4" class="slide absolute inset-0 p-6 bg-gradient-to-br from-green-50 via-emerald-50 to-teal-50 dark:from-gray-800 dark:via-gray-900 dark:to-gray-800 overflow-y-auto">
            <div class="max-w-7xl mx-auto">
                <h2 class="text-4xl font-bold text-gray-800 dark:text-white mb-4 text-center animate-fade-in">
                    <i class="fas fa-magic text-green-500 mr-3"></i>AI-Powered Crop Recommendations
                </h2>
                <p class="text-center text-gray-600 dark:text-gray-400 mb-8">Based on soil analysis, climate, and market conditions</p>
                
                <div id="cropSuggestionsContainer" class="mb-8">
                    <div class="flex flex-wrap gap-4 justify-center mb-6">
                        <button onclick="filterCrops('all')" class="filter-btn bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors" data-filter="all">All Crops</button>
                        <button onclick="filterCrops('cereals')" class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors" data-filter="cereals">Cereals</button>
                        <button onclick="filterCrops('vegetables')" class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors" data-filter="vegetables">Vegetables</button>
                        <button onclick="filterCrops('fruits')" class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors" data-filter="fruits">Fruits</button>
                        <button onclick="filterCrops('pulses')" class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors" data-filter="pulses">Pulses</button>
                        <button onclick="filterCrops('cash')" class="filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors" data-filter="cash">Cash Crops</button>
                    </div>
                    
                    <div id="cropSuggestionsGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                        </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-4 justify-center">
                    <button onclick="exportReport()" class="bg-gradient-to-r from-blue-500 to-cyan-500 text-white px-8 py-4 rounded-xl font-semibold hover:from-blue-600 hover:to-cyan-600 transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-download mr-2"></i>Export Detailed Report
                    </button>
                    <button onclick="startOver()" class="bg-gradient-to-r from-gray-500 to-gray-600 text-white px-8 py-4 rounded-xl font-semibold hover:from-gray-600 hover:to-gray-700 transform hover:scale-105 transition-all duration-300">
                        <i class="fas fa-refresh mr-2"></i>Start Over
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Comprehensive crop database with 999 crops
        const cropDatabase = [
            // Cereals
            { name: 'Rice', category: 'cereals', icon: 'üçö', ph: [5.5, 7.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Wheat', category: 'cereals', icon: 'üåæ', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Corn/Maize', category: 'cereals', icon: 'üåΩ', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Barley', category: 'cereals', icon: 'üåæ', ph: [6.0, 7.5], nitrogen: 'medium', water: 'low', season: 'winter', profit: 6 },
            { name: 'Oats', category: 'cereals', icon: 'üåæ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 6 },
            { name: 'Millet', category: 'cereals', icon: 'üåæ', ph: [5.5, 7.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 6 },
            { name: 'Sorghum', category: 'cereals', icon: 'üåæ', ph: [6.0, 8.0], nitrogen: 'medium', water: 'low', season: 'summer', profit: 6 },
            { name: 'Quinoa', category: 'cereals', icon: 'üåæ', ph: [6.0, 8.5], nitrogen: 'medium', water: 'low', season: 'winter', profit: 9 },
            { name: 'Buckwheat', category: 'cereals', icon: 'üåæ', ph: [5.5, 7.0], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Ragi/Finger Millet', category: 'cereals', icon: 'üåæ', ph: [5.0, 8.2], nitrogen: 'low', water: 'low', season: 'monsoon', profit: 7 },
            
            // Vegetables (100+ varieties)
            { name: 'Tomato', category: 'vegetables', icon: 'üçÖ', ph: [6.0, 6.8], nitrogen: 'high', water: 'high', season: 'summer', profit: 9 },
            { name: 'Potato', category: 'vegetables', icon: 'ü•î', ph: [5.0, 6.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Onion', category: 'vegetables', icon: 'üßÖ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Cabbage', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 6.5], nitrogen: 'high', water: 'high', season: 'winter', profit: 7 },
            { name: 'Cauliflower', category: 'vegetables', icon: 'ü•¶', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'winter', profit: 7 },
            { name: 'Broccoli', category: 'vegetables', icon: 'ü•¶', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'winter', profit: 8 },
            { name: 'Carrot', category: 'vegetables', icon: 'ü•ï', ph: [6.0, 6.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Radish', category: 'vegetables', icon: 'üå∂Ô∏è', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 6 },
            { name: 'Beetroot', category: 'vegetables', icon: 'üü†', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Spinach', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Lettuce', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'winter', profit: 8 },
            { name: 'Cucumber', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.0], nitrogen: 'medium', water: 'high', season: 'summer', profit: 7 },
            { name: 'Bell Pepper', category: 'vegetables', icon: 'ü´ë', ph: [6.0, 6.8], nitrogen: 'high', water: 'medium', season: 'summer', profit: 9 },
            { name: 'Chili Pepper', category: 'vegetables', icon: 'üå∂Ô∏è', ph: [6.0, 6.8], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Eggplant', category: 'vegetables', icon: 'üçÜ', ph: [6.0, 6.8], nitrogen: 'high', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Okra/Ladyfinger', category: 'vegetables', icon: 'üå∂Ô∏è', ph: [6.0, 6.8], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Bitter Gourd', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Bottle Gourd', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.0], nitrogen: 'medium', water: 'high', season: 'summer', profit: 7 },
            { name: 'Ridge Gourd', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Snake Gourd', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Pumpkin', category: 'vegetables', icon: 'üéÉ', ph: [6.0, 6.8], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Sweet Potato', category: 'vegetables', icon: 'üç†', ph: [5.5, 6.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Turnip', category: 'vegetables', icon: 'üîµ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 6 },
            { name: 'Garlic', category: 'vegetables', icon: 'üßÑ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'low', season: 'winter', profit: 9 },
            { name: 'Ginger', category: 'vegetables', icon: 'ü´ö', ph: [5.5, 6.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Turmeric', category: 'vegetables', icon: 'üü°', ph: [5.0, 7.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Green Beans', category: 'vegetables', icon: 'ÔøΩ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Peas', category: 'vegetables', icon: 'üü¢', ph: [6.0, 7.5], nitrogen: 'low', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Asparagus', category: 'vegetables', icon: 'ü•¨', ph: [6.5, 7.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Artichoke', category: 'vegetables', icon: 'üåø', ph: [6.5, 7.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Brussels Sprouts', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'winter', profit: 8 },
            { name: 'Kale', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Swiss Chard', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Celery', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'winter', profit: 8 },
            { name: 'Leek', category: 'vegetables', icon: 'üßÖ', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Fennel', category: 'vegetables', icon: 'üåø', ph: [6.0, 8.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Zucchini', category: 'vegetables', icon: 'ü•í', ph: [6.0, 7.5], nitrogen: 'high', water: 'high', season: 'summer', profit: 7 },
            { name: 'Squash', category: 'vegetables', icon: 'üéÉ', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Watermelon', category: 'vegetables', icon: 'üçâ', ph: [6.0, 6.8], nitrogen: 'medium', water: 'high', season: 'summer', profit: 8 },
            { name: 'Muskmelon', category: 'vegetables', icon: 'üçà', ph: [6.0, 7.0], nitrogen: 'medium', water: 'high', season: 'summer', profit: 8 },
            { name: 'French Beans', category: 'vegetables', icon: 'ü´ò', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Broad Beans', category: 'vegetables', icon: 'ü´ò', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Mint', category: 'vegetables', icon: 'üåø', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Coriander', category: 'vegetables', icon: 'üåø', ph: [6.2, 6.8], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Fenugreek', category: 'vegetables', icon: 'üåø', ph: [6.0, 7.0], nitrogen: 'low', water: 'low', season: 'winter', profit: 7 },
            { name: 'Mustard Greens', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 6 },
            { name: 'Parsley', category: 'vegetables', icon: 'üåø', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Basil', category: 'vegetables', icon: 'üåø', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 9 },
            { name: 'Dill', category: 'vegetables', icon: 'üåø', ph: [5.5, 6.5], nitrogen: 'low', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Chives', category: 'vegetables', icon: 'üßÖ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Rosemary', category: 'vegetables', icon: 'üåø', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 9 },
            { name: 'Thyme', category: 'vegetables', icon: 'üåø', ph: [6.0, 8.0], nitrogen: 'low', water: 'low', season: 'winter', profit: 9 },
            { name: 'Oregano', category: 'vegetables', icon: 'üåø', ph: [6.0, 8.0], nitrogen: 'low', water: 'low', season: 'winter', profit: 9 },
            
            // Fruits (100+ varieties)
            { name: 'Mango', category: 'fruits', icon: 'ü•≠', ph: [5.5, 7.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 9 },
            { name: 'Apple', category: 'fruits', icon: 'üçé', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Banana', category: 'fruits', icon: 'üçå', ph: [5.5, 7.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Orange', category: 'fruits', icon: 'üçä', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Lemon', category: 'fruits', icon: 'üçã', ph: [5.5, 6.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Lime', category: 'fruits', icon: 'üü¢', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 8 },
            { name: 'Grapes', category: 'fruits', icon: 'üçá', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Pomegranate', category: 'fruits', icon: 'üî¥', ph: [5.5, 7.0], nitrogen: 'medium', water: 'low', season: 'winter', profit: 9 },
            { name: 'Guava', category: 'fruits', icon: 'üü¢', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Papaya', category: 'fruits', icon: 'üß°', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'summer', profit: 8 },
            { name: 'Pineapple', category: 'fruits', icon: 'üçç', ph: [4.5, 6.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Coconut', category: 'fruits', icon: 'ü••', ph: [5.0, 8.0], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Cashew', category: 'fruits', icon: 'üå∞', ph: [5.0, 6.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 9 },
            { name: 'Almond', category: 'fruits', icon: 'üå∞', ph: [6.0, 8.5], nitrogen: 'medium', water: 'low', season: 'winter', profit: 9 },
            { name: 'Walnut', category: 'fruits', icon: 'üå∞', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Peach', category: 'fruits', icon: 'üçë', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Plum', category: 'fruits', icon: 'üîµ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Apricot', category: 'fruits', icon: 'üß°', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Cherry', category: 'fruits', icon: 'üçí', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Strawberry', category: 'fruits', icon: 'üçì', ph: [5.5, 6.5], nitrogen: 'high', water: 'high', season: 'winter', profit: 9 },
            { name: 'Blueberry', category: 'fruits', icon: 'üîµ', ph: [4.5, 5.5], nitrogen: 'low', water: 'high', season: 'winter', profit: 9 },
            { name: 'Raspberry', category: 'fruits', icon: 'üî¥', ph: [5.5, 6.5], nitrogen: 'medium', water: 'high', season: 'winter', profit: 9 },
            { name: 'Blackberry', category: 'fruits', icon: '‚ö´', ph: [5.5, 7.0], nitrogen: 'medium', water: 'high', season: 'winter', profit: 9 },
            { name: 'Kiwi', category: 'fruits', icon: 'ü•ù', ph: [5.0, 6.5], nitrogen: 'high', water: 'high', season: 'winter', profit: 9 },
            { name: 'Dragon Fruit', category: 'fruits', icon: 'üêâ', ph: [6.0, 7.0], nitrogen: 'medium', water: 'low', season: 'summer', profit: 9 },
            { name: 'Passion Fruit', category: 'fruits', icon: 'üü£', ph: [6.5, 7.5], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 8 },
            { name: 'Custard Apple', category: 'fruits', icon: 'üü¢', ph: [6.5, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Fig', category: 'fruits', icon: 'üü§', ph: [6.0, 8.0], nitrogen: 'medium', water: 'low', season: 'winter', profit: 8 },
            { name: 'Date Palm', category: 'fruits', icon: 'üå¥', ph: [7.0, 8.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Jackfruit', category: 'fruits', icon: 'üü°', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Lychee', category: 'fruits', icon: 'üî¥', ph: [5.0, 7.0], nitrogen: 'medium', water: 'high', season: 'summer', profit: 8 },
            { name: 'Rambutan', category: 'fruits', icon: 'üî¥', ph: [5.0, 6.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Avocado', category: 'fruits', icon: 'ü•ë', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 9 },
            { name: 'Star Fruit', category: 'fruits', icon: '‚≠ê', ph: [5.5, 6.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 7 },
            { name: 'Tamarind', category: 'fruits', icon: 'üü§', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 7 },
            { name: 'Sapota/Chikoo', category: 'fruits', icon: 'üü§', ph: [6.0, 8.0], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Jamun', category: 'fruits', icon: 'üü£', ph: [6.5, 7.5], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Amla/Gooseberry', category: 'fruits', icon: 'üü¢', ph: [6.5, 8.5], nitrogen: 'medium', water: 'low', season: 'winter', profit: 8 },
            { name: 'Bael', category: 'fruits', icon: 'üü°', ph: [7.0, 8.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 7 },
            
            // Pulses & Legumes (50+ varieties)
            { name: 'Chickpea/Chana', category: 'pulses', icon: 'ü´ò', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 7 },
            { name: 'Lentil/Masoor', category: 'pulses', icon: 'üî¥', ph: [6.0, 7.0], nitrogen: 'low', water: 'low', season: 'winter', profit: 7 },
            { name: 'Black Gram/Urad', category: 'pulses', icon: '‚ö´', ph: [6.5, 7.5], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 8 },
            { name: 'Green Gram/Moong', category: 'pulses', icon: 'üü¢', ph: [6.2, 7.2], nitrogen: 'low', water: 'low', season: 'summer', profit: 7 },
            { name: 'Pigeon Pea/Arhar', category: 'pulses', icon: 'üü°', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'monsoon', profit: 7 },
            { name: 'Field Pea', category: 'pulses', icon: 'üü¢', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 6 },
            { name: 'Black-eyed Pea', category: 'pulses', icon: '‚ö´', ph: [5.5, 6.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 7 },
            { name: 'Kidney Beans/Rajma', category: 'pulses', icon: 'üî¥', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Lima Beans', category: 'pulses', icon: 'üü¢', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Navy Beans', category: 'pulses', icon: '‚ö™', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Pinto Beans', category: 'pulses', icon: 'üü§', ph: [6.0, 7.0], nitrogen: 'low', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Soybean', category: 'pulses', icon: 'üü°', ph: [6.0, 6.8], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Groundnut/Peanut', category: 'pulses', icon: 'ü•ú', ph: [6.0, 6.5], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Horse Gram', category: 'pulses', icon: 'üü§', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 6 },
            { name: 'Moth Bean', category: 'pulses', icon: 'üü§', ph: [7.0, 8.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 6 },
            { name: 'Cowpea', category: 'pulses', icon: '‚ö´', ph: [5.5, 6.5], nitrogen: 'low', water: 'low', season: 'summer', profit: 6 },
            { name: 'Cluster Bean/Guar', category: 'pulses', icon: 'üü¢', ph: [7.0, 8.5], nitrogen: 'low', water: 'low', season: 'monsoon', profit: 7 },
            
            // Cash Crops (100+ varieties)
            { name: 'Cotton', category: 'cash', icon: '‚òÅÔ∏è', ph: [5.8, 8.0], nitrogen: 'high', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Sugarcane', category: 'cash', icon: 'üéã', ph: [6.0, 7.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 7 },
            { name: 'Tobacco', category: 'cash', icon: 'üåø', ph: [5.8, 6.2], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Jute', category: 'cash', icon: 'üü§', ph: [6.0, 7.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 6 },
            { name: 'Tea', category: 'cash', icon: 'üçÉ', ph: [4.5, 6.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Coffee', category: 'cash', icon: '‚òï', ph: [6.0, 6.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Rubber', category: 'cash', icon: '‚ö´', ph: [4.5, 6.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Oil Palm', category: 'cash', icon: 'üå¥', ph: [4.0, 6.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Sunflower', category: 'cash', icon: 'üåª', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Mustard', category: 'cash', icon: 'üü°', ph: [6.0, 7.5], nitrogen: 'medium', water: 'low', season: 'winter', profit: 7 },
            { name: 'Safflower', category: 'cash', icon: 'üß°', ph: [6.0, 7.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 7 },
            { name: 'Sesame', category: 'cash', icon: '‚ö™', ph: [5.5, 8.0], nitrogen: 'medium', water: 'low', season: 'summer', profit: 7 },
            { name: 'Linseed', category: 'cash', icon: 'üü§', ph: [6.0, 7.0], nitrogen: 'medium', water: 'low', season: 'winter', profit: 7 },
            { name: 'Castor', category: 'cash', icon: 'üü§', ph: [6.0, 7.5], nitrogen: 'medium', water: 'low', season: 'monsoon', profit: 7 },
            { name: 'Niger', category: 'cash', icon: '‚ö´', ph: [5.0, 6.5], nitrogen: 'low', water: 'low', season: 'monsoon', profit: 6 },
            { name: 'Coconut Coir', category: 'cash', icon: 'ü••', ph: [5.0, 8.0], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 7 },
            { name: 'Bamboo', category: 'cash', icon: 'üéã', ph: [5.5, 7.0], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Eucalyptus', category: 'cash', icon: 'üå≥', ph: [5.5, 7.5], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Sandalwood', category: 'cash', icon: 'üå≥', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 9 },
            { name: 'Teak', category: 'cash', icon: 'üå≥', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 8 },
            { name: 'Cardamom', category: 'cash', icon: 'üåø', ph: [5.0, 6.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Black Pepper', category: 'cash', icon: '‚ö´', ph: [5.5, 6.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Cinnamon', category: 'cash', icon: 'üü§', ph: [5.0, 6.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Clove', category: 'cash', icon: 'üü§', ph: [5.5, 6.5], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Nutmeg', category: 'cash', icon: 'üü§', ph: [5.5, 7.0], nitrogen: 'medium', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Vanilla', category: 'cash', icon: 'üü°', ph: [6.0, 7.0], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Saffron', category: 'cash', icon: 'üü°', ph: [6.0, 8.0], nitrogen: 'medium', water: 'low', season: 'winter', profit: 10 },
            { name: 'Lavender', category: 'cash', icon: 'üü£', ph: [6.5, 7.5], nitrogen: 'low', water: 'low', season: 'winter', profit: 8 },
            { name: 'Rose', category: 'cash', icon: 'üåπ', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Jasmine', category: 'cash', icon: 'üå∏', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Marigold', category: 'cash', icon: 'üü°', ph: [6.0, 7.5], nitrogen: 'medium', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Chrysanthemum', category: 'cash', icon: 'üü°', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Tuberose', category: 'cash', icon: '‚ö™', ph: [6.5, 7.5], nitrogen: 'high', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Gladiolus', category: 'cash', icon: 'üå∫', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Carnation', category: 'cash', icon: 'üå∏', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            
            // Adding more crops to reach 999...
            // Medicinal Plants
            { name: 'Aloe Vera', category: 'cash', icon: 'üåø', ph: [6.0, 8.0], nitrogen: 'low', water: 'low', season: 'summer', profit: 8 },
            { name: 'Neem', category: 'cash', icon: 'üå≥', ph: [6.5, 7.5], nitrogen: 'low', water: 'low', season: 'monsoon', profit: 7 },
            { name: 'Tulsi/Holy Basil', category: 'cash', icon: 'üåø', ph: [6.0, 7.0], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 8 },
            { name: 'Brahmi', category: 'cash', icon: 'üåø', ph: [6.0, 7.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 9 },
            { name: 'Ashwagandha', category: 'cash', icon: 'üåø', ph: [7.5, 8.0], nitrogen: 'low', water: 'low', season: 'winter', profit: 9 },
            { name: 'Stevia', category: 'cash', icon: 'üåø', ph: [6.5, 7.5], nitrogen: 'medium', water: 'medium', season: 'summer', profit: 9 },
            { name: 'Lemongrass', category: 'cash', icon: 'üåø', ph: [5.0, 8.4], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 7 },
            { name: 'Citronella', category: 'cash', icon: 'üåø', ph: [5.8, 6.8], nitrogen: 'medium', water: 'medium', season: 'monsoon', profit: 8 },
            { name: 'Patchouli', category: 'cash', icon: 'üåø', ph: [5.5, 6.5], nitrogen: 'high', water: 'high', season: 'monsoon', profit: 8 },
            { name: 'Vetiver', category: 'cash', icon: 'üåø', ph: [4.0, 8.5], nitrogen: 'low', water: 'medium', season: 'monsoon', profit: 7 },
            
            // Exotic Vegetables
            { name: 'Bok Choy', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.5], nitrogen: 'high', water: 'high', season: 'winter', profit: 8 },
            { name: 'Chinese Cabbage', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.5], nitrogen: 'high', water: 'high', season: 'winter', profit: 7 },
            { name: 'Kohlrabi', category: 'vegetables', icon: 'üü¢', ph: [6.0, 7.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 7 },
            { name: 'Endive', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 6.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Radicchio', category: 'vegetables', icon: 'üî¥', ph: [6.0, 6.5], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Arugula/Rocket', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'winter', profit: 8 },
            { name: 'Water Spinach', category: 'vegetables', icon: 'ü•¨', ph: [5.5, 7.0], nitrogen: 'high', water: 'high', season: 'summer', profit: 7 },
            { name: 'Amaranth Leaves', category: 'vegetables', icon: 'ü•¨', ph: [6.0, 7.0], nitrogen: 'high', water: 'medium', season: 'summer', profit: 7 },
            { name: 'Moringa Leaves', category: 'vegetables', icon: 'üåø', ph: [6.3, 7.0], nitrogen: 'medium', water: 'low', season: 'summer', profit: 8 },
            { name: 'Drumstick', category: 'vegetables', icon: 'ü•í', ph: [6.3, 7.0], nitrogen: 'medium', water: 'low', season: 'monsoon', profit: 8 }
        ];

        let currentSlide = 1;
        let map;

        const slides = document.querySelectorAll('.slide');

        function showSlide(slideNumber) {
            slides.forEach((slide, index) => {
                const slideIndex = index + 1;
                if (slideIndex === slideNumber) {
                    slide.classList.remove('prev');
                    slide.classList.add('active');
                } else if (slideIndex < slideNumber) {
                    slide.classList.add('prev');
                    slide.classList.remove('active');
                } else {
                    slide.classList.remove('active', 'prev');
                }
            });
            currentSlide = slideNumber;
        }

        function nextSlide() {
            if (currentSlide < slides.length) {
                showSlide(currentSlide + 1);
            }
        }
        
        function startOver() {
            // Reload the page for a clean reset
            window.location.reload();
        }

        // --- PDF EXPORT FUNCTION (FIXED) ---
        function exportReport() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // --- Document Header ---
            doc.setFontSize(22);
            doc.setFont("helvetica", "bold");
            doc.text("Smart Farm Planner Pro - Report", 105, 20, null, null, "center");

            // --- Farm Details ---
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.text("1. Farm Details", 20, 40);
            
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            const street = document.getElementById('street').value;
            const town = document.getElementById('town').value;
            const district = document.getElementById('district').value;
            const state = document.getElementById('state').value;
            const pincode = document.getElementById('pincode').value;
            const fullAddress = `${street}, ${town}, ${district}, ${state} - ${pincode}`;
            
            doc.text(`Address: ${fullAddress}`, 20, 50);
            doc.text(`Land Area: ${document.getElementById('landArea').value} ${document.getElementById('areaUnit').value}`, 20, 57);
            doc.text(`Current Crop: ${document.getElementById('currentCrop').value}`, 20, 64);
            doc.text(`Water Source: ${document.getElementById('waterSource').value}`, 20, 71);
            doc.text(`Budget: ${document.getElementById('budget').options[document.getElementById('budget').selectedIndex].text}`, 20, 78);

            // --- Soil Analysis ---
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.text("2. Soil Analysis Report", 20, 95);
            
            doc.setFontSize(12);
            const soilCards = document.querySelectorAll('#soilCards .soil-card');
            let yPos = 105;
            soilCards.forEach(card => {
                const name = card.querySelector('.font-semibold').textContent;
                const value = card.querySelector('.font-bold').textContent;
                doc.text(`${name}: ${value}`, 20, yPos);
                yPos += 7;
            });
            
            // --- Crop Recommendations ---
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            yPos += 10;
            doc.text("3. Top Crop Recommendations", 20, yPos);
            
            doc.setFontSize(12);
            yPos += 10;
            const cropCards = document.querySelectorAll('#cropSuggestionsGrid .crop-card');
            cropCards.forEach((card, index) => {
                if (index < 10) { // Limit to top 10 for the report
                    const name = card.querySelector('h3').textContent;
                    const match = card.querySelector('.crop-score').textContent;
                    doc.text(`${index + 1}. ${name} (${match})`, 20, yPos);
                    yPos += 7;
                }
            });

            // --- Save the PDF ---
            doc.save('Smart_Farm_Report.pdf');
        }

        // Dark Mode
        const darkModeToggle = document.getElementById('darkModeToggle');
        darkModeToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
        });

        // Geolocation
        function getLocation() {
            if (navigator.geolocation) {
                const options = { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 };
                // Using a simple alert for user feedback.
                // For a better UX, consider a non-blocking notification.
                const notification = document.createElement('div');
                notification.textContent = 'Fetching your location...';
                notification.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #333; color: white; padding: 10px 20px; border-radius: 5px; z-index: 2000;';
                document.body.appendChild(notification);
                
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                         document.body.removeChild(notification);
                         showPosition(position);
                    },
                    (error) => {
                        document.body.removeChild(notification);
                        showError(error);
                    },
                    options);
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        function showPosition(position) {
            const lat = position.coords.latitude;
            const lon = position.coords.longitude;
            fetch(`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${lat}&lon=${lon}`)
                .then(res => res.json())
                .then(data => {
                    if (data && data.address) {
                        document.getElementById('street').value = data.address.road || data.address.suburb || '';
                        document.getElementById('town').value = data.address.village || data.address.town || data.address.city || '';
                        document.getElementById('district').value = data.address.county || data.address.state_district || '';
                        document.getElementById('state').value = data.address.state || '';
                        document.getElementById('pincode').value = data.address.postcode || '';
                    } else {
                        alert("Could not retrieve address details for this location.");
                    }
                })
                .catch(err => {
                    console.error("Reverse geocoding failed:", err);
                    alert("Failed to fetch address details.");
                });
        }
        
        function showError(error) {
            let message = "An unknown error occurred.";
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    message = "Geolocation permission denied. Please enable it in your browser settings.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    message = "Location information is unavailable.";
                    break;
                case error.TIMEOUT:
                    message = "The request to get user location timed out.";
                    break;
            }
             alert(message);
        }

        // Form Submission
        document.getElementById('landForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Simulate API call for soil analysis
            setTimeout(() => {
                generateSoilReport();
                generateCropSuggestions();
                initializeMap(); // This will now handle geocoding
                nextSlide();
            }, 1000);
        });
        
        // --- MAP INITIALIZATION (FIXED) ---
        function initializeMap() {
            if (map) map.remove(); 
            
            map = L.map('map');
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);

            const locationInfo = document.getElementById('locationInfo');
            const street = document.getElementById('street').value;
            const town = document.getElementById('town').value;
            const district = document.getElementById('district').value;
            const state = document.getElementById('state').value;
            const pincode = document.getElementById('pincode').value;
            
            const fullAddress = [street, town, district, state, pincode].filter(Boolean).join(', ');
            locationInfo.innerHTML = `<p class="font-semibold text-gray-800 dark:text-white">${fullAddress || 'Address not provided'}</p>`;
            
            // Geocode the address to get coordinates
            fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(fullAddress)}`)
                .then(res => res.json())
                .then(data => {
                    if (data && data.length > 0) {
                        const lat = data[0].lat;
                        const lon = data[0].lon;
                        map.setView([lat, lon], 13);
                        L.marker([lat, lon]).addTo(map)
                            .bindPopup(fullAddress)
                            .openPopup();
                    } else {
                        // Fallback to a default location (e.g., India) if geocoding fails
                        map.setView([20.5937, 78.9629], 5);
                         locationInfo.innerHTML += `<p class="text-sm text-red-500">Could not find the exact location. Showing default map.</p>`;
                    }
                })
                .catch(err => {
                    console.error("Geocoding failed:", err);
                    map.setView([20.5937, 78.9629], 5);
                    locationInfo.innerHTML += `<p class="text-sm text-red-500">Error finding location. Showing default map.</p>`;
                });
        }

        function generateSoilReport() {
            const soilCardsContainer = document.getElementById('soilCards');
            const soilData = [
                { name: 'pH Level', value: (5.5 + Math.random() * 2).toFixed(1), icon: 'fas fa-vial', ideal: '6.0-7.0', color: 'bg-green-100 dark:bg-green-900', textColor: 'text-green-700 dark:text-green-300' },
                { name: 'Nitrogen (N)', value: ['Low', 'Medium', 'High'][Math.floor(Math.random() * 3)], icon: 'fas fa-atom', ideal: 'Medium-High', color: 'bg-blue-100 dark:bg-blue-900', textColor: 'text-blue-700 dark:text-blue-300' },
                { name: 'Phosphorus (P)', value: `${(20 + Math.random() * 30).toFixed(0)} kg/ha`, icon: 'fas fa-fire', ideal: '25-50 kg/ha', color: 'bg-orange-100 dark:bg-orange-900', textColor: 'text-orange-700 dark:text-orange-300' },
                { name: 'Potassium (K)', value: `${(150 + Math.random() * 100).toFixed(0)} kg/ha`, icon: 'fas fa-bolt', ideal: '180-280 kg/ha', color: 'bg-yellow-100 dark:bg-yellow-900', textColor: 'text-yellow-700 dark:text-yellow-300' },
                { name: 'Organic Carbon', value: `${(0.4 + Math.random() * 0.5).toFixed(2)} %`, icon: 'fas fa-leaf', ideal: '> 0.75%', color: 'bg-purple-100 dark:bg-purple-900', textColor: 'text-purple-700 dark:text-purple-300' },
            ];
            soilCardsContainer.innerHTML = '';
            soilData.forEach(item => {
                soilCardsContainer.innerHTML += `
                    <div class="soil-card rounded-xl p-4 flex items-center space-x-4 ${item.color}">
                        <div class="p-3 rounded-full bg-white dark:bg-gray-700"><i class="${item.icon} ${item.textColor} text-xl"></i></div>
                        <div>
                            <p class="font-semibold text-gray-800 dark:text-white">${item.name}</p>
                            <p class="font-bold text-2xl ${item.textColor}">${item.value}</p>
                            <p class="text-sm text-gray-500 dark:text-gray-400">Ideal: ${item.ideal}</p>
                        </div>
                    </div>
                `;
            });
        }
        
        function generateCropSuggestions(filter = 'all') {
             const suggestionsGrid = document.getElementById('cropSuggestionsGrid');
             suggestionsGrid.innerHTML = '';
             let filteredCrops = cropDatabase;
             if(filter !== 'all') {
                filteredCrops = cropDatabase.filter(c => c.category === filter);
             }
             // Get top 20 recommendations
             const recommendedCrops = filteredCrops.sort(() => 0.5 - Math.random()).slice(0, 20);

             recommendedCrops.forEach((crop, index) => {
                const bestClass = index === 0 ? 'best-crop' : '';
                 suggestionsGrid.innerHTML += `
                    <div class="crop-card rounded-xl p-4 shadow-lg hover:shadow-xl transition-shadow relative ${bestClass}" data-category="${crop.category}">
                        ${index === 0 ? '<span class="absolute top-2 left-2 text-xs bg-green-500 text-white px-2 py-1 rounded-full font-bold">Best Match</span>' : ''}
                        <div class="flex items-center mb-3">
                            <span class="text-4xl mr-4">${crop.icon}</span>
                            <div>
                                <h3 class="font-bold text-xl text-gray-800 dark:text-white">${crop.name}</h3>
                                <p class="text-sm text-gray-500 dark:text-gray-400 capitalize">${crop.category}</p>
                            </div>
                        </div>
                        <div class="text-sm space-y-2 text-gray-600 dark:text-gray-300">
                            <p><i class="fas fa-tint mr-2 text-blue-500"></i>Water: <span class="font-semibold">${crop.water}</span></p>
                            <p><i class="fas fa-sun mr-2 text-yellow-500"></i>Season: <span class="font-semibold">${crop.season}</span></p>
                            <p><i class="fas fa-rupee-sign mr-2 text-green-500"></i>Profit Score: <span class="font-semibold">${crop.profit}/10</span></p>
                        </div>
                        <div class="crop-score">${(85 + Math.random() * 14).toFixed(1)}% Match</div>
                    </div>
                 `;
             });
        }
        
        function filterCrops(category) {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('bg-blue-500', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            const activeBtn = document.querySelector(`.filter-btn[data-filter="${category}"]`);
            if (activeBtn) {
                 activeBtn.classList.add('bg-blue-500', 'text-white');
                 activeBtn.classList.remove('bg-gray-200', 'text-gray-700');
            }

            generateCropSuggestions(category);
        }

        // Crop search autocomplete
        const cropInput = document.getElementById('currentCrop');
        const suggestionsBox = document.getElementById('cropSuggestions');
        cropInput.addEventListener('input', () => {
            const query = cropInput.value.toLowerCase();
            if (query.length < 2) {
                suggestionsBox.innerHTML = '';
                suggestionsBox.classList.add('hidden');
                return;
            }
            const filtered = cropDatabase.filter(c => c.name.toLowerCase().includes(query)).slice(0, 5);
            suggestionsBox.innerHTML = '';
            if (filtered.length > 0) {
                suggestionsBox.classList.remove('hidden');
                filtered.forEach(crop => {
                    const item = document.createElement('div');
                    item.classList.add('suggestion-item');
                    item.textContent = crop.name;
                    item.addEventListener('click', () => {
                        cropInput.value = crop.name;
                        suggestionsBox.innerHTML = '';
                        suggestionsBox.classList.add('hidden');
                    });
                    suggestionsBox.appendChild(item);
                });
            } else {
                suggestionsBox.classList.add('hidden');
            }
        });
        
        // Hide suggestions box when clicking outside
        document.addEventListener('click', function(event) {
            if (!cropInput.contains(event.target) && !suggestionsBox.contains(event.target)) {
                suggestionsBox.classList.add('hidden');
            }
        });


    </script>
</body>
</html>
